#
# Copyright (c) 2018 Wind River Systems, Inc.
#
# SPDX-License-Identifier: Apache-2.0
#

# Tox (http://tox.testrun.org/) is a tool for running tests
# in multiple virtualenvs. This configuration file will run the
# test suite on all supported python versions. To use it, "pip install tox"
# and then run "tox" from this directory.
[tox]
toxworkdir = /tmp/{env:USER}_puppet-manifests
envlist = puppetlint
skipsdist = True

[testenv]
recreate = True

[testenv:puppetlint]
deps =
whitelist_externals =
    gem
    bash
setenv =
    GEM_HOME = {envdir}
    GEM_PATH = {envdir}
skip_tests = \
    --no-140chars \
    --no-2sp_soft_tabs \
    --no-arrow_alignment \
    --no-arrow_on_right_operand_line-check \
    --no-autoloader_layout-check \
    --no-case_without_default \
    --no-documentation-check \
    --no-double_quoted_strings-check \
    --no-ensure_first_param \
    --no-hard_tabs \
    --no-inherits_across_namespaces \
    --no-only_variable_string \
    --no-parameter_order \
    --no-quoted_booleans \
    --no-single_quote_string_with_variables \
    --no-trailing_whitespace \
    --no-variable_is_lowercase-check \
    --no-variables_not_enclosed
commands =
    gem install --no-document puppet-lint
    bash -c "find {toxinidir} -name \*.pp -print0 | xargs -0 puppet-lint {[testenv:puppetlint]skip_tests}"

